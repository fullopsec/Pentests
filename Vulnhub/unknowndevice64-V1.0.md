## Vulnhub - unknowndevice64

### Network Discovery

Using `netdiscover`, we identified a device with the IP address `192.168.1.30`.

### Service Enumeration

Running an `nmap` scan with the `vulners` script, we discovered the following open ports and associated services:

- Port 1337: SSH service running OpenSSH 7.7.
- Port 31337: HTTP service hosting SimpleHTTPServer 0.6 on Python 2.7.14.

### Web Application Analysis

Upon visiting `http://192.168.1.30:31337`, we found a web page with an image in the source code that hinted at a hidden key (`key_is_h1dd3n.jpg`). 

![image](https://github.com/fullopsec/Pentests/assets/114147068/3b6de131-b4d7-406b-a69e-41c54822c0ff)

Downloading the image revealed an encoded message, which was deciphered using steganography and the key "h1dd3n". 

```
echo h1dd3n >test.txt 
stegseek key_is_h1dd3n.jpg test.txt

```

The decoded message appeared as `++++++++++[>+>+++>+++++++>++++++++++<<<<-]>>>>+++++++++++++++++.-----------------.<----------------.--.++++++.---------.>-----------------------.<<+++.++.>+++++.--.++++++++++++.>++++++++++++++++++++++++++++++++++++++++.-----------------.`

Decoding this using the Brainfuck language (https://www.dcode.fr/cipher-identifier) resulted in the string `ud64:1M!#64@ud`, which was used as the credentials to gain SSH access.

![image](https://github.com/fullopsec/Pentests/assets/114147068/0aed276c-7311-43ae-93c6-7853ddc97dcd)


### Privilege Escalation

After accessing the SSH shell, we encountered limited command execution. 

![image](https://github.com/fullopsec/Pentests/assets/114147068/c8cbbb34-61d8-4b91-9eb3-dc1abba81896)

![image](https://github.com/fullopsec/Pentests/assets/114147068/9db5ff89-1456-4c84-891c-8c8a1e328ee1)

We edited path in .bash_profile

`/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin`

Through further investigation, we found that the modified path in the `.bash_profile` file wasn't initially effective but eventually took effect upon reconnecting to the SSH session.

Using the command `find / -perm -u=s -type f 2>/dev/null`, we identified the `strace` command, which could be executed via `sudo` using the `sysud64` program, providing an opportunity for privilege escalation.

![image](https://github.com/fullopsec/Pentests/assets/114147068/0bdb66c1-2107-4b2f-ad78-b8e0a1612983)

![image](https://github.com/fullopsec/Pentests/assets/114147068/748b52b1-dce5-4fa9-88a5-ef11d5454b40)

GTFOBIN has a command for strace: https://gtfobins.github.io/gtfobins/strace/#sudo

![image](https://github.com/fullopsec/Pentests/assets/114147068/48d6f482-4a84-47aa-aa5e-18a4a1ae8292)


### Conclusion

In conclusion, the penetration test conducted on the Vulnhub machine "unknowndevice64" exposed several security vulnerabilities, including a misconfigured path, restricted shell access, and an exploitable privilege escalation through the strace command 
