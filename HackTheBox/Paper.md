# Penetration Test Report

## Introduction

This penetration test report documents the assessment of a target with IP address 10.10.11.143. The target had three open ports: 22 (SSH), 80 (HTTP), and 443 (SSL/HTTP). The report details the techniques and commands used during the assessment.

## Initial Enumeration

### Nmap Scan

The initial port scan was performed using Nmap to identify open ports on the target:

```shell
nmap -sV 10.10.11.143 -p-
```

- Port 22/tcp: Open SSH (OpenSSH 8.0, protocol 2.0)
- Port 80/tcp: Open HTTP (Apache httpd 2.4.37, CentOS)
- Port 443/tcp: Open SSL/HTTP (Apache httpd 2.4.37, CentOS)

## Web Application Assessment

### Directory Enumeration with Dirb

Dirb was used to enumerate directories and files on the webserver:

```shell
dirb http://10.10.11.143/
```

### Exploring "office.paper"

Using Sn1per:

![image](https://github.com/fullopsec/Pentests/assets/114147068/0a1af457-d8de-46d4-a981-44acd7318d6a)


The suggestion to use "wfuff" for subdomain scanning was followed, and the domain "office.paper" was added to the hosts file for further investigation.

```shell
echo "10.10.11.143 office.paper" >> /etc/hosts
```

### WordPress Enumeration

A WordPress installation was discovered on the "office.paper" domain:

![image](https://github.com/fullopsec/Pentests/assets/114147068/dae40f6c-7a2a-4b5c-867e-44924f22c4fe)


WPScan was used to enumerate WordPress users:

```shell
wpscan --url http://office.paper --disable-tls-checks --enumerate u
```

![image](https://github.com/fullopsec/Pentests/assets/114147068/0ca9cbed-2ed9-4d15-bf20-3b3b71c9bfcc)


This identified several users, including "prisonmike," "nick," and "creedthoughts"

### Vulnerable Plugins Enumeration

The enumeration of vulnerable plugins was performed using WPScan:

```shell
wpscan --url http://office.paper --disable-tls-checks --enumerate vp
```

no result

### WordPress Draft Exploitation

An insecure draft was found on the WordPress site. A Google search led to the discovery of a WordPress draft exploit:

![image](https://github.com/fullopsec/Pentests/assets/114147068/c021297d-eaa3-4ffe-8446-88cc033c4faf)


https://www.exploit-db.com/exploits/47690

By appending "?static=1" to a WordPress URL, the secret content of the draft was exposed:

http://office.paper/?static=1

The URL found in the insecure draft was accessed, requiring an addition to the hosts file

The hosts file was updated:

```shell
sudo sed -i 's/10.10.11.143/10.10.11.143 chat.office.paper/g' /etc/hosts
```

![image](https://github.com/fullopsec/Pentests/assets/114147068/5d0eb4f1-a6f9-4add-b448-d57dfa4f897c)


### Rocket.Chat Exploitation

Upon registering an account on the new "chat.office.paper" URL, a bot named "recyclops" was discovered in the chat. A conversation with the bot revealed that it could fetch files.

Commands such as 'recyclops get me the file test.txt' or 'recyclops file test.txt' were used to fetch files. The bot responded by sending back file content.

![image](https://github.com/fullopsec/Pentests/assets/114147068/80ef67b9-b4b6-41b5-a38e-77058a7c3fae)

![image](https://github.com/fullopsec/Pentests/assets/114147068/1905b5cc-4032-4961-8501-f1abe1c52465)

clear password in file ../hubot/.env (the bots send back file content)

![image](https://github.com/fullopsec/Pentests/assets/114147068/b668bc85-f7d0-402b-9fd4-f4ab5b58adee)


The bot revealed sensitive information, including credentials:

- `Queenofblad3s`: Dwight's password

  ![image](https://github.com/fullopsec/Pentests/assets/114147068/109101c0-812d-4e04-84ed-c20bd9710644)


### Privilege Escalation

To escalate privileges, the following steps were taken:

1. Connecting via SSH as user "dwight" using the obtained password.
2. Launching LinEnum (lse) to enumerate system information.

LinEnum results highlighted:

- Uncommon setuid binaries.
- GIT/SVN repositories.
- The presence of SELinux.
- Services listening only on localhost.
- Apache modules.
- Write access to a gpg-agent socket.
- Processes running with root permissions.

Polkit pwnkit was identified as a vulnerability. CVE-2021-3560 was exploited using the provided PoC script:

![image](https://github.com/fullopsec/Pentests/assets/114147068/989ce176-61d8-42ee-bb61-300daf53ba55)


https://raw.githubusercontent.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation/main/poc.sh

The user "secnigma" was escalated to root privileges:

```shell
su - secnigma
sudo su
```

We are root.

## Conclusion

In conclusion, this penetration test successfully identified vulnerabilities in the target system, allowing for WordPress enumeration, Rocket.Chat exploitation, and ultimately, privilege escalation through CVE-2021-3560. The report provides a detailed account of the techniques and commands used during the assessment.
